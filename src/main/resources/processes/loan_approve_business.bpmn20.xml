<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:modeler="http://activiti.com/modeler" xmlns:tns="http://www.activiti.org/processdef" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/processdef" id="m1516543981212" name="">
  <signal id="cancelApplication" name="cancelApplication"></signal>
  <process id="loanProcess" name="消费贷流程" isExecutable="true" isClosed="false" processType="None">
    <startEvent id="start_process" name="流程启动"></startEvent>
    <userTask id="usertask_bank_credit_record" name="银行征信录入" activiti:candidateGroups="bank_credit_user_group"></userTask>
    <userTask id="usertask_social_credit_record" name="社会征信录入" activiti:candidateGroups="social_credit_user_group"></userTask>
    <parallelGateway id="parallelgateway1" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow4" sourceRef="parallelgateway1" targetRef="usertask_bank_credit_record"></sequenceFlow>
    <sequenceFlow id="flow5" sourceRef="parallelgateway1" targetRef="usertask_social_credit_record"></sequenceFlow>
    <userTask id="usertask_loan_approve" name="业务申请" activiti:candidateGroups="partners"></userTask>
    <userTask id="usertask_telephone_verify" name="电审信息"></userTask>
    <userTask id="usertask_visit_verify" name="上门调查"></userTask>
    <sequenceFlow id="flow13" sourceRef="usertask_visit_verify" targetRef="usertask_telephone_verify"></sequenceFlow>
    <userTask id="usertask_car_insurance_record" name="车辆保险"></userTask>
    <userTask id="usertask_gps_install" name="GPS安装"></userTask>
    <parallelGateway id="parallelgateway3" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow17" sourceRef="parallelgateway3" targetRef="usertask_car_insurance_record"></sequenceFlow>
    <sequenceFlow id="flow18" sourceRef="parallelgateway3" targetRef="usertask_gps_install"></sequenceFlow>
    <userTask id="usertask_pay_approve" name="放款审批"></userTask>
    <parallelGateway id="parallelgateway4" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow20" sourceRef="usertask_car_insurance_record" targetRef="parallelgateway4"></sequenceFlow>
    <sequenceFlow id="flow21" sourceRef="usertask_gps_install" targetRef="parallelgateway4"></sequenceFlow>
    <userTask id="usertask_contract_print" name="合同套打"></userTask>
    <sequenceFlow id="flow22" sourceRef="parallelgateway4" targetRef="usertask_contract_print"></sequenceFlow>
    <userTask id="usertask_license_mortgage" name="上牌抵押"></userTask>
    <sequenceFlow id="flow23" sourceRef="usertask_contract_print" targetRef="usertask_license_mortgage"></sequenceFlow>
    <userTask id="usertask_pay_done" name="财务打款"></userTask>
    <sequenceFlow id="flow24" sourceRef="usertask_pay_approve" targetRef="usertask_pay_done"></sequenceFlow>
    <parallelGateway id="parallelgateway5" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow25" sourceRef="usertask_license_mortgage" targetRef="parallelgateway5"></sequenceFlow>
    <sequenceFlow id="flow26" sourceRef="usertask_pay_done" targetRef="parallelgateway5"></sequenceFlow>
    <endEvent id="endevent1" name="End"></endEvent>
    <sequenceFlow id="flow27" sourceRef="parallelgateway5" targetRef="endevent1"></sequenceFlow>
    <userTask id="usertask_telephone_verify_review" name="电审复审信息"></userTask>
    <sequenceFlow id="flow35" sourceRef="usertask_telephone_verify_review" targetRef="parallelgateway3"></sequenceFlow>
    <sequenceFlow id="flow36" sourceRef="usertask_telephone_verify" targetRef="usertask_telephone_verify_review"></sequenceFlow>
    <userTask id="usertask_credit_verify" name="征信申请审核" activiti:candidateGroups="partner_group"></userTask>
    <sequenceFlow id="flow38" sourceRef="start_process" targetRef="usertask_credit_apply"></sequenceFlow>
    <sequenceFlow id="flow39" sourceRef="usertask_credit_verify" targetRef="exclusivegateway2"></sequenceFlow>
    <parallelGateway id="parallelgateway6" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow40" sourceRef="usertask_bank_credit_record" targetRef="parallelgateway6"></sequenceFlow>
    <sequenceFlow id="flow41" sourceRef="usertask_social_credit_record" targetRef="parallelgateway6"></sequenceFlow>
    <sequenceFlow id="flow42" sourceRef="parallelgateway6" targetRef="usertask_loan_approve"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow43" sourceRef="usertask_loan_approve" targetRef="exclusivegateway1"></sequenceFlow>
    <sequenceFlow id="flow44" sourceRef="exclusivegateway1" targetRef="usertask_telephone_verify"></sequenceFlow>
    <sequenceFlow id="flow45" sourceRef="exclusivegateway1" targetRef="usertask_visit_verify"></sequenceFlow>
    <userTask id="usertask_credit_apply" name="发起征信申请" activiti:candidateGroups="partner_group"></userTask>
    <sequenceFlow id="flow46" sourceRef="usertask_credit_apply" targetRef="servicetask_credit_save"></sequenceFlow>
    <serviceTask id="servicetask_credit_save" name="征信申请存储" activiti:expression="${creditServiceImpl.create(execution)}"></serviceTask>
    <sequenceFlow id="flow47" sourceRef="servicetask_credit_save" targetRef="usertask_credit_verify"></sequenceFlow>
    <endEvent id="endevent3" name="End"></endEvent>
    <sequenceFlow id="flow50" sourceRef="usertask_telephone_verify" targetRef="endevent3"></sequenceFlow>
    <endEvent id="endevent4" name="End"></endEvent>
    <sequenceFlow id="flow51" sourceRef="usertask_telephone_verify_review" targetRef="endevent4"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway2" name="Exclusive Gateway"></exclusiveGateway>
    <endEvent id="endevent5" name="End"></endEvent>
    <sequenceFlow id="flow53" sourceRef="exclusivegateway2" targetRef="endevent5">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${processAction == “CANCEL”}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow54" sourceRef="exclusivegateway2" targetRef="usertask_credit_apply">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${processAction == “REJECT”}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="usertask_busi_examine" name="业务审批"></userTask>
    <sequenceFlow id="flow55" sourceRef="usertask_busi_examine" targetRef="usertask_pay_approve"></sequenceFlow>
    <sequenceFlow id="flow56" sourceRef="exclusivegateway2" targetRef="parallelgateway1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${processAction == “PASS”}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow57" sourceRef="parallelgateway3" targetRef="usertask_busi_examine"></sequenceFlow>
  </process>
</definitions>